/* =====================
       PALETA MEDULA (Desktop)
       ===================== */
    :root {
      --brand-1: #29a5ff;         /* azul claro gradient start */
      --brand-2: #1560ff;         /* azul profundo gradient end */
      --brand-3: #0b4de2;         /* acento oscuro */
      --bg: #f5f7fb;              /* fondo general */
      --surface: #ffffff;         /* tarjetas */
      --border: #dfe5ef;          /* borde suave */
      --muted: #eff2f7;           /* superficies suaves */
      --text: #0f1b2d;            /* texto principal */
      --text-2: #5a6b87;          /* texto secundario */
      --success: #10b981;         /* ok */
      --danger: #ef4444;
      --warning-50: #fff7ed; --warning-200:#fed7aa; --warning-800:#7c2d12;
      --info-50:#eff6ff; --info-200:#bfdbfe; --info-800:#1e40af;
      --type-consulta: #2563eb;   /* azul */
      --type-examen: #7c3aed;     /* violeta */
      --type-medicamento: #059669;/* verde */
      --radius-lg: 16px;
      --shadow: 0 10px 28px rgba(8, 23, 54, 0.08);
      --focus: 0 0 0 3px rgba(21, 96, 255, .28);
       --base-font: 17px;         /* +legible para adultos */
    }

    /* TIPOGRAFÍA: Fira Sans (opcional). Coloca el archivo en assets/fonts/FiraSans-Variable.woff2 */
    @font-face {
      font-family: "Fira Sans";
      src: url("assets/fonts/FiraSans-Variable.woff2") format("woff2-variations");
      font-weight: 100 900;
      font-style: normal;
      font-display: swap;
    }

    /* Fuente accesible por defecto */
    html { font-size: var(--base-font); }
    body {
      margin: 0; background: var(--bg); color: var(--text);
      font-family: "Fira Sans", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, Noto Sans;
      line-height: 1.6;
    }

    /* Accesibilidad: tamaños y temas */
    body.theme-dark {
      --bg: #0f1222; --surface:#151a2d; --text:#e6e9f4; --text-2:#b8c2d6; --border:#2a3452; --muted:#1a2036;
      --brand-1:#4ca9ff; --brand-2:#2a6dff;
    }
    

    /* Layout 25 / auto / 560 */
    .app { min-width: 1280px; height: 100vh; display:flex; }
    .sidebar { width: 340px; background: var(--surface); border-right: 1px solid var(--border); display:flex; flex-direction:column; }
    .main { flex: 1; overflow:auto; }
    .right { width: 640px; background: var(--panel); border-left: 1px solid var(--border); overflow:auto; }
    body.theme-dark .right{ background: var(--panel); }
    

    /* Utilidades */
    .p-6{padding:24px;} .p-5{padding:20px;} .p-4{padding:16px;} .mb-4{margin-bottom:16px;}
    .space-y-8>{margin-top:32px;} 
    .space-y-7>{margin-top:28px;} 
    .space-y-5>{margin-top:20px;} 
    .space-y-4>{margin-top:16px;} 
    .space-y-3>{margin-top:12px;}
    .flex{display:flex;} 
    .items-center{align-items:center;} .between{justify-content:space-between;}
    .gap-2{gap:8px;} .gap-3{gap:12px;} .gap-4{gap:16px;}

    /* Marca */
    .brand-badge{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,var(--brand-1),var(--brand-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;box-shadow:var(--shadow)}
    .brand-title{margin:0;font-weight:800;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));-webkit-background-clip:text;background-clip:text;color:transparent;letter-spacing:0.5px}
    .subtitle{color:var(--text-2);font-size:.95rem;margin:2px 0 0}
    .side-header{border-bottom:1px solid var(--border); background: var(--sidehead);} 

    /* Botones */
    .btn{display:inline-flex;align-items:center;gap:10px;border:1px solid var(--border);background:#fff;color:var(--text);padding:12px 16px;border-radius:12px;cursor:pointer;font-weight:700;min-height:44px;}
    .btn:hover{background:var(--muted)}
    .btn-primary{background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:#fff;border-color:transparent}
    .btn-ghost{background:transparent}
    .btn-outline{background:#fff}
    .btn:focus{outline:none;box-shadow:var(--focus)}
    .segmented{display:inline-flex;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:var(--muted)}
    .segmented button{border:0;background:transparent;padding:9px 12px;cursor:pointer;font-weight:700;color:var(--text);border-right:1px solid var(--border)}
    .segmented button[aria-pressed="true"]{background:#eef5ff;color:#1f3556;box-shadow:inset 0 0 0 1px #cfe0ff}
    body.theme-dark .btn, body.theme-dark .btn-outline{ background:#1a2138; color:var(--text); border-color:#263255 }
    body.theme-dark .btn:hover{ background:#212a47 }

    /* Inputs accesibles */
    .field{display:grid;gap:6px}
    input[type="text"], input[type="date"], input[type="time"], select, textarea{
      border:1px solid var(--border); border-radius:12px; padding:12px 14px; font:inherit; background:#fff; color: var(--text);
    }
    body.theme-dark input, body.theme-dark select, body.theme-dark textarea{ background:#1a2138; color:var(--text); border-color:#2a3452 }
    textarea{min-height:88px; resize:vertical}
    input:focus, select:focus, textarea:focus{outline:none;box-shadow:var(--focus)}

    /* Navegación */
    nav[aria-label="Secciones"] a{display:flex;align-items:center;gap:12px;padding:12px 14px;border-radius:12px;text-decoration:none;color:var(--text);border:1px solid transparent;font-weight:700}
    nav[aria-label="Secciones"] a:hover{background:var(--muted)}
    nav[aria-label="Secciones"] a.active{background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:#fff}
    .nav-icon{width:22px;height:22px;display:inline-flex;align-items:center;justify-content:center;border-radius:8px;background:rgba(21,96,255,.08);color:#1850ff;font-weight:800}

    /* Tarjetas */
    .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);box-shadow:var(--shadow)}
    body.theme-dark .card{ background:#161b2d; border-color:#2a3452 }

    /* Badges y separadores */
    .badge{display:inline-flex;align-items:center;border:1px solid var(--border);border-radius:999px;padding:2px 10px;font-size:.9rem;color:var(--text-2);background:#fff}
    .badge.ok{background:#ecfdf5;border-color:#a7f3d0;color:#065f46}
    .separator{height:1px;background:var(--border);margin:8px 0}

    /* Contenido principal */
    .page-title{font-size:1.6rem;font-weight:800;margin:0}

    /* Historial */
    .entry{display:flex;align-items:flex-start;justify-content:space-between}
    .entry-left{display:flex;align-items:flex-start;gap:14px}
    .icon-circle{width:42px;height:42px;border-radius:12px;background:linear-gradient(135deg,var(--brand-1),var(--brand-2));color:#fff;display:flex;align-items:center;justify-content:center;font-size:20px}

    /* Medicamentos */
    .med-row{display:flex;align-items:center;justify-content:space-between}
    .pill-icon{width:46px;height:46px;border-radius:14px;background:linear-gradient(135deg,var(--brand-1),var(--brand-2));display:flex;align-items:center;justify-content:center;color:#fff;font-size:22px}
    .progress{width:120px;height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden}
    .progress>span{display:block;height:100%;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));}

    /* Exámenes */
    .doc-icon{width:46px;height:46px;border-radius:14px;background:rgba(21,96,255,.08);display:flex;align-items:center;justify-content:center;color:#1850ff;font-size:20px}

    /* Perfil */
    .grid-2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
    .label{color:var(--text-2);font-size:1rem;margin-bottom:4px}

    /* Panel derecho — más espacio para Calendario + Citas */
    /* .right .card{border-radius:18px} */
    .right h3{margin:0 0 10px;font-size:1.1rem}

    /* Calendario mensual amplio (desktop) */
    .calendar{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);box-shadow:var(--shadow)}
    .cal-head{padding:18px 20px;border-bottom:1px solid var(--border);display:grid;grid-template-columns:auto 1fr auto;grid-template-areas:"actions title toolbar" "search search search";row-gap:12px;column-gap:16px}
.cal-actions{grid-area:actions}
.cal-title{grid-area:title;min-width:220px;text-align:center;font-weight:800}
.cal-toolbar{grid-area:toolbar;display:flex;gap:12px;align-items:center;justify-self:end}
.cal-search{grid-area:search;display:flex;align-items:center;gap:10px;background:#eef5ff;border:1px solid #cfe0ff;border-radius:12px;padding:10px 12px}
.cal-search .icon{opacity:.7}
.cal-search input{width:100%;border:0;background:transparent;outline:none;font:inherit;color:var(--text)}
.cal-search input::placeholder{color:var(--text-2)}
body.theme-dark .cal-search{background:#151b2d;border-color:#2a3452}
body.theme-dark .cal-search .icon{color:#cbd5e1}
body.theme-dark .cal-search input{color:#e5e7eb}
body.theme-dark .cal-search input::placeholder{color:#9aa6bf}
    .cal-title{font-weight:800;min-width:220px;text-align:center}
    .cal-actions{display:flex;gap:8px;align-items:center}
    .cal-toolbar{display:flex;gap:12px;align-items:center}
    .search{display:flex;align-items:center;gap:8px}
    .search input{width:240px}

    /* Month Grid */
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;padding:16px}
    .cal-dow{font-size:.9rem;color:var(--text-2);text-transform:uppercase;letter-spacing:.05em;text-align:center;padding:6px 0}
    .cal-cell{background:var(--surface);border:1px solid var(--border);min-height:136px;border-radius:12px;padding:8px;position:relative}
    .cal-cell .events{margin-top:6px;display:grid;gap:6px}
    .cal-day{font-size:1rem;color:var(--text-2)}
    .count{position:absolute;top:8px;right:8px;background:#DCEBFF;color:#1f3556;border:1px solid #c7d7f5;border-radius:999px;min-width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:.85rem;font-weight:800}
    .cal-event{display:block;font-size:.95rem;padding:6px 8px;border-radius:10px;border:1px solid #cfe0ff;color:#0d233a;background:#F2F8FF;}
    .cal-event[data-type="consulta"]{background:rgba(37,99,235,.10);border-color:rgba(37,99,235,.25);color:#1e3a8a}
    .cal-event[data-type="examen"]{background:rgba(124,58,237,.12);border-color:rgba(124,58,237,.28);color:#4c1d95}
    .cal-event[data-type="medicamento"]{background:rgba(5,150,105,.12);border-color:rgba(5,150,105,.28);color:#064e3b}
    .flash{animation:flash 1.6s ease-in-out 1}
    @keyframes flash{0%{box-shadow:0 0 0 0 rgba(21,96,255,.6)}60%{box-shadow:0 0 0 16px rgba(21,96,255,.0)}100%{box-shadow:0 0 0 0 rgba(21,96,255,0)}}

    /* Weekly view */
    #weekView{padding:16px}
    .week-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
    .week-col{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:10px;min-height:220px}
    .week-col h4{margin:0 0 8px;font-weight:800;color:var(--text-2)}
    .week-item{margin:8px 0;padding:8px 10px;border-radius:10px;border:1px solid transparent}
    .week-item[data-type="consulta"]{background:rgba(37,99,235,.10);border-color:rgba(37,99,235,.25);}
    .week-item[data-type="examen"]{background:rgba(124,58,237,.12);border-color:rgba(124,58,237,.28);}
    .week-item[data-type="medicamento"]{background:rgba(5,150,105,.12);border-color:rgba(5,150,105,.28);}

    /* List view */
    #listView{padding:16px}
    .list-day{margin:8px 0;padding:12px;border:1px solid var(--border);background:var(--surface);border-radius:12px}
    .list-day h4{margin:0 0 8px;font-weight:800;color:var(--text-2)}

    /* Próximas Citas — tarjetas más grandes */
    .appt{padding:14px;border:1px solid var(--border);border-radius:14px;background:var(--surface)}
    .appt-time{display:flex;align-items:center;gap:8px;color:var(--text-2);font-weight:700}
    .appt strong{font-weight:800}

    a:focus,button:focus,input:focus,select:focus,textarea:focus{outline:none;box-shadow:var(--focus)}
    mark{background:#fff59d;padding:0 2px;border-radius:2px}

    /* ====== PRINT ====== */
    @media print {
      .sidebar, .right, .segmented, .search, .btn, nav[aria-label="Secciones"] { display:none !important; }
      .app, .main { width:100% !important; min-width:auto !important; }
      body { background:#fff; }
    }

    /* ===== Modal ===== */
    .modal{position:fixed;inset:0;background:rgba(2,6,23,.55);display:none;align-items:center;justify-content:center;padding:20px;z-index:50}
    .modal.open{display:flex}
    .modal-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);max-width:720px;width:100%}
    .modal-card .head{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--border)}
    .modal-card .body{padding:16px}
  #btn-sync-gcal, #btn-logout{ white-space:nowrap; font-size:0.78rem !important; padding:6px 10px !important; min-height:32px !important; }
  /* Skip link accesible */
    .skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip-link:focus{left:16px;top:16px;width:auto;height:auto;padding:8px 12px;z-index:100;background:var(--brand-2);color:#fff;border-radius:8px}

    /* Leyenda calendario */
    .cal-legend{display:flex;gap:12px;align-items:center;justify-content:flex-end;padding:8px 16px 0;color:var(--text-2)}
    .cal-legend span{display:inline-flex;align-items:center;gap:8px;font-size:.95rem}
    .cal-dot{display:inline-block;width:10px;height:10px;border-radius:50%}
    .cal-dot.consulta{background:rgba(37,99,235,.85)}
    .cal-dot.examen{background:rgba(124,58,237,.85)}
    .cal-dot.medicamento{background:rgba(5,150,105,.85)}

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce){ .flash{animation:none!important} *{scroll-behavior:auto} }

    /* Dark mode automático del sistema */
    @media (prefers-color-scheme: dark){
      :root{ --panel-surface:#151a2d; }
      .cal-cell,.week-col,.list-day,.appt{ background: var(--surface); border-color: var(--border); }
      .cal-event[data-type="consulta"], .week-item[data-type="consulta"]{ background: rgba(37,99,235,.20); border-color: rgba(37,99,235,.40); color:#cfe1ff; }
      .cal-event[data-type="examen"], .week-item[data-type="examen"]{ background: rgba(124,58,237,.22); border-color: rgba(124,58,237,.42); color:#e9d5ff; }
      .cal-event[data-type="medicamento"], .week-item[data-type="medicamento"]{ background: rgba(5,150,105,.20); border-color: rgba(5,150,105,.42); color:#bbf7d0; }
    }

    :root{ --panel:#e2e8f5; --panel-surface:#f3f6fc; }
  /* ===== Modo noche sin brillos: afinado de componentes ===== */
    @media (prefers-color-scheme: dark){
      /* Superficies: cero blancos intensos */
      .cal-cell,.week-col,.list-day,.appt{ background: var(--surface); border-color: var(--border); }
      /* Botones e inputs más oscuros */
      .btn{ background:#1a2138; border-color:#263255; color:#e6e9f4; }
      .btn:hover{ background:#212a47; }
      .btn-primary{ background:linear-gradient(90deg,#234a97,#1c3f85); color:#eaf2ff; border-color:transparent; }
      input[type="text"], input[type="date"], input[type="time"], select, textarea{
        background:#1a2138; color:#e6e9f4; border-color:#2a3452;
      }
      /* Insignia de conteo del calendario: evitar brillo */
      .count{ background:#233a6b; border:1px solid #3e5a94; color:#cfe1ff; }
      /* Badges suaves */
      .badge{ background:transparent; border-color:#3a4d78; color:#cfe1ff; }
      /* Iconos de secciones menos saturados */
      .brand-badge,.pill-icon,.icon-circle{ background:linear-gradient(135deg,#1f2b5e,#16244a); color:#e6efff; }
      .doc-icon{ background:#1a294a; color:#9cc1ff; }
      /* Leyenda de tipos: puntos más apagados */
      .cal-dot.consulta{ background:#3259b3; }
      .cal-dot.examen{ background:#5630a6; }
      .cal-dot.medicamento{ background:#1f6a52; }
      /* Chips de evento: ya estaban atenuados, se mantienen */
      .cal-event[data-type="consulta"], .week-item[data-type="consulta"]{ background: rgba(37,99,235,.14); border-color: rgba(37,99,235,.35); color:#d5e4ff; }
      .cal-event[data-type="examen"], .week-item[data-type="examen"]{ background: rgba(124,58,237,.16); border-color: rgba(124,58,237,.36); color:#e4d7ff; }
      .cal-event[data-type="medicamento"], .week-item[data-type="medicamento"]{ background: rgba(5,150,105,.14); border-color: rgba(5,150,105,.34); color:#d4ffe6; }
      /* Barra de progreso en oscuro */
      .progress{ background:#2a3452; }
      .progress>span{ background:#3456a8; }
    }
  /* Right panel low-glare (light mode) */
    .right .card,
    .right .calendar,
    .right .cal-cell,
    .right .week-col,
    .right .list-day,
    .right .appt { background: var(--panel-surface); }
    .right .count{ background:#e3ebff; color:#1e3a8a; }
  /* ==== MODO NOCHE ESTRICTO (sin colores intensos) ==== */
    body.theme-dark{ --focus:0 0 0 3px rgba(148,163,184,.35); --brand-1:#2a3146; --brand-2:#2a3146; }
    /* Marca y títulos sin gradientes brillantes */
    body.theme-dark .brand-title{ background:none !important; color:#e5e7eb !important; }
    body.theme-dark .brand-badge, body.theme-dark .pill-icon, body.theme-dark .icon-circle{ background:#20263a !important; color:#e5e7eb !important; box-shadow:none; }
    body.theme-dark .doc-icon{ background:#1b2236 !important; color:#cbd5e1 !important; }
    body.theme-dark .nav-icon{ background:#1b2236 !important; color:#cbd5e1 !important; }

    /* Botones e inputs neutros */
    body.theme-dark .btn{ background:#181e31; border-color:#242c46; color:#e5e7eb; }
    body.theme-dark .btn:hover{ background:#1c2338; }
    body.theme-dark .btn-primary{ background:#2a3146 !important; border-color:#2a3146 !important; color:#e5e7eb !important; }
    body.theme-dark input[type="text"], body.theme-dark input[type="date"], body.theme-dark input[type="time"], body.theme-dark select, body.theme-dark textarea{ background:#1a2138; color:#e6e9f4; border-color:#2a3452; }

    /* Calendario y tarjetas totalmente neutros */
    body.theme-dark .calendar, body.theme-dark .card{ background:#151a2d; border-color:#2a3452; }
    body.theme-dark .cal-cell, body.theme-dark .week-col, body.theme-dark .list-day, body.theme-dark .appt{ background:#141a2b; border-color:#2a3452; }
    body.theme-dark .count{ background:#1e2538; color:#cbd5e1; border:1px solid #2d3654; }
    body.theme-dark .badge{ background:transparent; border-color:#2f3a5a; color:#cbd5e1; }

    /* Leyenda de tipos: puntos grises (sin cromas) */
    body.theme-dark .cal-dot.consulta,
    body.theme-dark .cal-dot.examen,
    body.theme-dark .cal-dot.medicamento{ background:#6b7280 !important; }

    /* Progreso neutro */
    body.theme-dark .progress{ background:#232a45; }
    body.theme-dark .progress>span{ background:#2d3654; }

    /* Panel derecho oscurecido de forma consistente */
    body.theme-dark .right{ background:#11162a; }
    body.theme-dark .right .card,
    body.theme-dark .right .calendar,
    body.theme-dark .right .cal-cell,
    body.theme-dark .right .week-col,
    body.theme-dark .right .list-day,
    body.theme-dark .right .appt{ background:#141a2b; }

  /* ===== Calendario en modo noche: celestes suaves (sin fatiga) ===== */
    body.theme-dark .cal-event, body.theme-dark .week-item{ background:#141b2a !important; border-color:#253354 !important; color:#dbe7f7 !important; }
    body.theme-dark .cal-event[data-type="consulta"], body.theme-dark .week-item[data-type="consulta"]{ background:rgba(82,134,197,.18) !important; border-color:rgba(82,134,197,.36) !important; color:#d9e7ff !important; }
    body.theme-dark .cal-event[data-type="examen"], body.theme-dark .week-item[data-type="examen"]{ background:rgba(94,118,190,.16) !important; border-color:rgba(94,118,190,.34) !important; color:#dde3ff !important; }
    body.theme-dark .cal-event[data-type="medicamento"], body.theme-dark .week-item[data-type="medicamento"]{ background:rgba(64,142,156,.16) !important; border-color:rgba(64,142,156,.34) !important; color:#d7f4ff !important; }
    body.theme-dark .cal-dot.consulta{ background:#4b6ea8 !important; }
    body.theme-dark .cal-dot.examen{ background:#495f9c !important; }
    body.theme-dark .cal-dot.medicamento{ background:#3a7a86 !important; }
    body.theme-dark .count{ background:#1b2742 !important; border:1px solid #2a3a5d !important; color:#cfe3ff !important; }
  :root{ --sidehead:#eaf2ff; }
    body.theme-dark .side-header{ background:#1a2744; border-bottom-color:#2f3f6a; }
    body.theme-dark .user-badge{ background:#1f2b44 !important; color:#d3e3ff !important; }
  /* Segmented (dark): celestes suaves y no fatigosos */
    body.theme-dark .segmented{background:#151b2d;border-color:#2a3452}
    body.theme-dark .segmented button{color:#b8c2d6;border-right-color:#2a3452}
    body.theme-dark .segmented button[aria-pressed="true"]{background:rgba(82,134,197,.18);color:#dbe7f7;box-shadow:inset 0 0 0 1px rgba(82,134,197,.36)}
    .segmented button:last-child{border-right:0}
  /* ====== MODO DÍA (forzado cuando el botón desactiva noche) ====== */
    body:not(.theme-dark) .card,
    body:not(.theme-dark) .calendar,
    body:not(.theme-dark) .cal-cell,
    body:not(.theme-dark) .week-col,
    body:not(.theme-dark) .list-day,
    body:not(.theme-dark) .appt { background: var(--surface) !important; border-color: var(--border) !important; }

    /* Panel derecho: cajas claras reales (no oscuras en día) */
    body:not(.theme-dark) .right .card,
    body:not(.theme-dark) .right .calendar,
    body:not(.theme-dark) .right .cal-cell,
    body:not(.theme-dark) .right .week-col,
    body:not(.theme-dark) .right .list-day,
    body:not(.theme-dark) .right .appt { background: var(--surface) !important; }

    /* Calendario: mejorar contraste de tipografía en día */
    .cal-event, .cal-event:link, .cal-event:visited { color: var(--text) !important; text-decoration: none; }
    .cal-event:hover { text-decoration: underline; }
    body:not(.theme-dark) .cal-event{ font-weight: 600; }

    .cal-day { color: var(--text-2); font-weight: 600; }
    /* Resalta número del día si hay eventos (requiere :has, soportado en navegadores modernos) */
    .cal-grid .cal-cell:has(.events a) .cal-day { color: var(--text); }

    /* Vista semana/lista: títulos de evento con buen contraste */
    .week-item strong { color: var(--text); }
  /* ==== Forzar superficies claras en MODO DÍA (sin afectar noche) ==== */
    body:not(.theme-dark){
      --surface:#ffffff; /* tarjetas y cajas */
      --panel:#eaf0fb;   /* fondo del panel derecho */
      --panel-surface:#f7f9ff; /* superficies suaves del panel */
      --muted:#eff2f7;
      --text:#0f1b2d; --text-2:#5a6b87; --border:#dfe5ef;
    }
    body:not(.theme-dark) .card,
    body:not(.theme-dark) .calendar,
    body:not(.theme-dark) .cal-cell,
    body:not(.theme-dark) .week-col,
    body:not(.theme-dark) .list-day,
    body:not(.theme-dark) .appt{
      background:#ffffff !important; border-color: var(--border) !important;
    }
    /* Panel derecho: también cajas claras reales */
    body:not(.theme-dark) .right .card,
    body:not(.theme-dark) .right .calendar,
    body:not(.theme-dark) .right .cal-cell,
    body:not(.theme-dark) .right .week-col,
    body:not(.theme-dark) .right .list-day,
    body:not(.theme-dark) .right .appt{
      background:#ffffff !important;
    }
    /* Botones e inputs claros en día, aunque el SO esté en oscuro */
    body:not(.theme-dark) .btn,
    body:not(.theme-dark) .btn-outline{
      background:#ffffff !important; color:var(--text) !important; border-color:var(--border) !important;
    }
    body:not(.theme-dark) input[type="text"],
    body:not(.theme-dark) input[type="date"],
    body:not(.theme-dark) input[type="time"],
    body:not(.theme-dark) select,
    body:not(.theme-dark) textarea{
      background:#ffffff !important; color:var(--text) !important; border-color:var(--border) !important;
    }
    /* Tipografía de eventos claramente legible en día */
    body:not(.theme-dark) .cal-event{ color:var(--text) !important; font-weight:600; }
    body:not(.theme-dark) .week-item strong{ color:var(--text) !important; }
    /* Badge de conteo en día: celeste suave, alto contraste */
    body:not(.theme-dark) .count{ background:#DCEBFF !important; color:#1f3556 !important; border-color:#c7d7f5 !important; }
  /* === Historial Médico: badge de fecha con color de marca y alto contraste === */
    .entry .badge:not(.ok){
      background:#e8f2ff;           /* celeste suave (marca) */
      border-color:#b7d0ff;         /* borde celeste leve */
      color:#0b3a75;                /* texto azul oscuro para contraste */
      font-weight:800;
    }
    /* Modo noche: celeste desaturado, sin brillos */
    body.theme-dark .entry .badge:not(.ok){
      background:#1a2a47;           /* azul pizarra */
      border-color:#2c477a;         /* borde tenue */
      color:#d6e6ff;                /* texto claro legible */
    }
  /* === Historial Médico: badge de fecha con color de marca y alto contraste === */
    .entry .badge:not(.ok){
      background:#e8f2ff;           /* celeste suave (marca) */
      border-color:#b7d0ff;         /* borde celeste leve */
      color:#0b3a75;                /* texto azul oscuro para contraste */
      font-weight:800;
    }
    /* Modo noche: celeste desaturado, sin brillos */
    body.theme-dark .entry .badge:not(.ok){
      background:#1a2a47;           /* azul pizarra */
      border-color:#2c477a;         /* borde tenue */
      color:#d6e6ff;                /* texto claro legible */
    }
  /* === Historial Médico: badge de fecha con color de marca y alto contraste === */
    .entry .badge:not(.ok){
      background:#e8f2ff;           /* celeste suave (marca) */
      border-color:#b7d0ff;         /* borde celeste leve */
      color:#0b3a75;                /* texto azul oscuro para contraste */
      font-weight:800;
    }
    /* Modo noche: celeste desaturado, sin brillos */
    body.theme-dark .entry .badge:not(.ok){
      background:#1a2a47;           /* azul pizarra */
      border-color:#2c477a;         /* borde tenue */
      color:#d6e6ff;                /* texto claro legible */
    }
  .form-head{display:flex;align-items:center;justify-content:space-between;gap:12px}
.form-head #btn-sync-gcal{margin-left:auto}
  /* ===== Usuario: tarjeta accesible (día y noche) ===== */
    .user-card{ background:#e7f0ff; border:1px solid #bfd3ff; border-radius:12px; padding:10px 12px; box-shadow:0 6px 16px rgba(21,96,255,.08); }
    .user-card .subtitle{ color:#2b4f87; }
    body.theme-dark .user-card{ background:#2e4a82; border-color:#5a77b1; box-shadow:0 10px 20px rgba(4,8,20,.38); }
    body.theme-dark .user-card .subtitle{ color:#e8f0ff; }
  /* ===== Navegación sin JS con :target y :has() ===== */
    .section{display:none}
    .section.default{display:block}
    body:has(.section:target) .section.default{display:none}
    .section:target{display:block}

    /* Activo en el menú según la sección visible */
    body:not(:has(.section:target)) nav[aria-label="Secciones"] a[href="#historial"],
    body:has(#historial:target) nav[aria-label="Secciones"] a[href="#historial"],
    body:has(#medicamentos:target) nav[aria-label="Secciones"] a[href="#medicamentos"],
    body:has(#examenes:target) nav[aria-label="Secciones"] a[href="#examenes"],
    body:has(#perfil:target) nav[aria-label="Secciones"] a[href="#perfil"]{
      background:linear-gradient(90deg,var(--brand-1),var(--brand-2));
      color:#fff
    }

    /* User card como botón (link de área completa) */
    .user-card{ position:relative; cursor:pointer; }
    .user-card .stretched-link{ position:absolute; inset:0; border-radius:12px; text-indent:-9999px; }
    .user-card:hover{ filter:brightness(1.02) }
    .user-card:focus-within{ outline:none; box-shadow:var(--focus) }


